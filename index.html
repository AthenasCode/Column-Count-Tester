<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Column-Count Tester</title>
    <link rel="stylesheet" href="./styles.css" />
    <script defer src="./blockGenerator.js"></script>
  </head>
  <body>
    <header>
      <h1>Column-Count Tester</h1>
    </header>
    <main>
      <section id="explanation">
        <h2>About</h2>
        <p><em>Last updated 18 November 2023</em></p>
        <p>
          On iPhones and iPads, CSS's column-count property seems to behave
          differently. Users on other devices are unlikely to see a difference
          between the below columns. However, if you are viewing this on an
          iPhone or iPad*, you may see below that the first section has
          misaligned columns. This seems to be a result of the margin of the
          bottom item of the first column separating from its block and shifting
          to the top of the second column.
          <br /><br />
          If you go back far enough, this happens on other devices. On Chrome 56
          (2017) on Windows 11, the same thing happens. It looks like they fixed
          that in 57. On Chrome 40 (2014), the blocks don't display at all. But
          on an iPad Pro 12.9 (2022), the misalignment occurs on both Safari and
          Chrome. If you keep testing on older devices and browsers, you might
          see other problems such as the blocks themselves breaking over the
          column. Here are a couple of resources from several years ago that
          explain this behaviour in more detail:
        </p>
        <ul>
          <li>
            <a
              href="https://stackoverflow.com/questions/33769524/css-multi-column-layout-margin-issue"
              >A StackOverflow answer from eight years ago</a
            >
            that claims that the display of the columns is also affected by
            whether there is an odd or even number of elements. I haven't tested
            this.
          </li>
          <li>
            <a
              href="https://zomigi.com/blog/deal-breaker-problems-with-css3-multi-columns/"
              >An article from 2010</a
            >
            explaining deal-breaker problems with CSS3 multi-columns.
          </li>
        </ul>

        <p>
          *Note that this behaviour does not show up if you use DevTools to view
          the page on an iPad or iPhone. If you don't have access to those
          devices, you can use a site like
          <a href="https://live.browserstack.com">BrowserStack</a> or
          <a href="https://www.lambdatest.com/">LambdaTest</a> to test it
          yourself.
        </p>
        <p>
          Depending on what browser and device you are using, there may be other
          differences. For example, when I view this page (on Windows 10) on
          Firefox (version 119.0.1), the column sections are both of equal
          height. But if I view it in Chrome (version 119.0.6045.160), the first
          column section is 10px shorter. It looks like the bottom margin of the
          bottom-most block is collapsing into the padding of the column
          section. To my understanding, this shouldn't happen, as margin
          collapsing only occurs between margins, not margins and padding. I
          might investigate this at some other time, but something tells me this
          is a rabbit hole that will never end.
        </p>

        <h3>CSS</h3>
        <p>
          Each column-section has the following styles:<br /><br />.column-section
          { <br />-webkit-column-count: 2; <br />-moz-column-count: 2;
          <br />column-count: 2;<br />
          column-gap: 10px; <br />margin: 0 auto;<br />
          border: 1px solid black; <br />padding: 10px;<br />
          }
        </p>

        <p>
          Each coloured block has the following styles: <br /><br />
          .block { <br />
          -webkit-column-count: 2;<br />
          -moz-column-count: 2;<br />border: 1px solid black;<br />
          width: 100%;<br />
          box-sizing: border-box;<br />
          margin-bottom: 10px;<br />
          break-inside: avoid-column;<br />
          }
        </p>
        <p>
          The colours are applied dynamically using JavaScript. Finally, the
          block "display" property has been set as indicated below. Note also
          that the inline-block blocks have also been given the property
          "vertical-align: top". There seems to be some background
          vertical-align property being applied to inline-block elements by
          default, and "vertical-align: top" ensures that the gap between blocks
          is exactly the size of the margin-bottom property.
        </p>
        <h3>
          <a
            href="https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_flow_layout/Block_and_inline_layout_in_normal_flow"
            >"Block" vs "inline-block"</a
          >
        </h3>
        <ul>
          <li>
            <strong>Block:</strong> "Boxes are laid out one after the other,
            vertically, beginning at the top of a containing block. The vertical
            distance between two sibling boxes is determined by the 'margin'
            properties. Vertical margins between adjacent block-level boxes in a
            block formatting context collapse."
          </li>
          <li>
            <strong>Inline-block:</strong> "Boxes are laid out horizontally, one
            after the other, beginning at the top of a containing block.
            Horizontal margins, borders, and padding are respected between these
            boxes. The boxes may be aligned vertically in different ways: their
            bottoms or tops may be aligned, or the baselines of text within them
            may be aligned."
          </li>
        </ul>
      </section>
      <section id="columns-section">
        <div class="container">
          <p>display: block</p>
          <div id="columns-block" class="column-section"></div>
        </div>

        <div class="container">
          <p>display: inline-block; vertical-align: top</p>
          <div id="columns-inline-block" class="column-section"></div>
        </div>
      </section>
    </main>
    <footer></footer>
  </body>
</html>
